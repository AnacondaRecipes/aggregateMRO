
{% set pfx = 'r-' %}
{% set version = '3.4.3' %}
{% set rc_version = '3.4.3' %}

{% set url = 'https://mran.blob.core.windows.net/install/mro/3.4.3/microsoft-r-open-3.4.3.exe' %}  # [win64]
{% set fn = 'microsoft-r-open-3.4.3.exe' %}  # [win64]
{% set shasum = 'c8d50172ec8173cef503a616f9ef310dc5b274ac045ea71b9c8aed248098cbdd' %}  # [win64]

{% set url = 'https://mran.blob.core.windows.net/install/mro/3.4.3/microsoft-r-open-3.4.3.tar.gz' %}  # [linux64]
{% set fn = 'microsoft-r-open-3.4.3.tar.gz' %}  # [linux64]
{% set shasum = 'bf2cd35a11db604b1fa8f5f0c0acf0ae05756020d90fb3f6cbb639337efcee5b' %}  # [linux64]

{% set url = 'https://mran.blob.core.windows.net/install/mro/3.4.3/microsoft-r-open-3.4.3.pkg' %}  # [osx]
{% set fn = 'microsoft-r-open-3.4.3.pkg' %}  # [osx]
{% set shasum = '4998500839389821f995d3ebb89ee7e8e5a35a61a63ba0ac54d63adf53288947' %}  # [osx]

package:
  name: mro-suite
  version: {{ version }}

source:
  - url: {{ url }}
    fn: {{ fn }}
    sha256: {{ shasum }}
    folder: unpack
  - url: https://repo.continuum.io/pkgs/free/linux-64/mkl-2017.0.1-0.tar.bz2  # [linux64]
    sha256: 89be3b0077bd1b7cc75feaec6eec8e33b0b118f7f9056d15be5d3ead05bdf9e9  # [linux64]
    folder: anaconda-mkl  # [linux64]
#  - url: https://packages.microsoft.com/rhel/6/prod/microsoft-r-client-packages-{{ rc_version }}.rpm  # [linux64]
#    sha256: 5fd191776bfb5cfb6e2bac54a466ccc2714372b620d1fb1a82e19e40d3962d31  # [linux64]
#    folder: unpack-r-client  # [linux64]
  - url: ~/conda/microsoft-r-client-packages-{{ rc_version }}.rpm  # [linux64]
    sha256: 336c59f2199c72b2dbdcd2d505e7ea77b186dc3139b3ab8933b75a13d080b8cd  # [linux64]
    folder: unpack-r-client  # [linux64]
  - url: ~/conda/microsoft-r-client-mml-3.4.3.rpm  # [linux64]
    sha256: 0411f0baff4359c0937f2786de714c0e62b0bb808485899fcdcc3cdd85964ae8  # [linux64]
    folder: unpack-r-client-mml  # [linux64]
  - url: ~/conda/microsoft-r-client-mlm-3.4.3.rpm  # [linux64]
    sha256: 878d6dad7e96f3d3d49ee4661987f58dd213ba04df244ac37244f15530e52f99  # [linux64]
    folder: unpack-r-client-mlm  # [linux64]
#  - url: https://rserverdistribution.azureedge.net/production/RClient/3.4.1.0/1360/1033/0900ccb335c04a048f26b4bb3320aef8/RClientSetup.exe  # [win64]
#    sha256: 011cb6eddb4ad58cb8c3de4032a2243187c879eefa7cf82896dbdc3823c1944f  # [win64]
#    folder: unpack-r-client  # [win64]
  - url: ~/conda/RClientSetup.exe  # [win64]
    sha256: 44dca045e6e5e8083377ee17aedcf2ca0ccd8ac9518a7f173ad934bd127dad5a  # [win64]
    folder: unpack-r-client  # [win64]
  - url: https://github.com/wixtoolset/wix3/releases/download/wix311rtm/wix311-binaries.zip  # [win64]
    sha256: da034c489bd1dd6d8e1623675bf5e899f32d74d6d8312f8dd125a084543193de                 # [win64]
    folder: wix                                                                              # [win64]
  # The normal RevoUtils looks in the Windows Registry to determine if it's the Client or the Server version.
  # We do not write to the Windows Registry so were provided with this one instead.
  - url: ./RevoUtils_10.0.8.zip                                                              # [win64]
    sha256: b0b4fd446fe4251f0962066aba8623da4bbfb682616188b0f4792ec0e05fdb7e                 # [win64]
    folder: RevoUtils                                                                        # [win64]

requirements:
  build:
    - python-libarchive-c
    - posix  # [win]
    - m2-p7zip  # [win]
  host:
    - m2w64-toolchain  # [win]
    - m2-base  # [win]

outputs:
  - name: mro-base
    version: {{ version }}
    script: install-mro-base.sh
    build:
      rpaths:
        - lib/R/lib/
        - lib/
      no_link:
        # These files are modified by R CMD javareconf and can
        # point to different Java implementations in each env.
        - lib/R/etc/Makeconf
        - lib/R/etc/ldpaths
        - lib/R/etc/javaconf
        - lib/R/etc/x64/Makeconf
        - lib/R/etc/x64/ldpaths
        - lib/R/etc/x64/javaconf
    requirements:
      build:
        - m2-base  # [win]
        - {{ compiler('fortran') }}  # [not win]
        - {{ compiler('cxx') }}  # [not win]
        - {{ compiler('c') }}  # [not win]
        - {{ cdt('xorg-x11-proto-devel') }}  # [linux]
        - {{ cdt('libxrender') }}            # [linux]
        - {{ cdt('libxext') }}               # [linux]
        - {{ cdt('libuuid') }}               # [linux]
        - {{ cdt('libsm-devel') }}           # [linux]
        - {{ cdt('libice-devel') }}          # [linux]
        - {{ cdt('libx11-devel') }}          # [linux]
        - {{ cdt('libxft') }}                # [linux]
        - {{ cdt('libxt') }}                 # [linux]
        - {{ cdt('libxt-devel') }}           # [linux]
        - {{ cdt('libxcb') }}                # [linux]
        - {{ cdt('libxau') }}                # [linux]
        - {{ cdt('java-1.7.0-openjdk') }}    # [linux]
      host:
        - libgfortran >=3.0.1  # [osx]
        - llvm-openmp >=4.0.1  # [osx]
        - expat  # [osx]
        - libcurl  # [osx]
        - libiconv  # [osx]
        - ncurses  # [osx]
        - libgcc-ng >=7.2.0  # [linux]
        - zlib  # [linux]
        - libgfortran-ng >=7.2.0 # [linux]
        - pango 1.40.*  # [linux]
        - cairo 1.14.*  # [linux]
        - glib 2.*  # [linux]
      run:
        - _r-mutex 1.* mro_2
        - {{ compiler('fortran') }}  # [not win]
        - {{ compiler('cxx') }}  # [not win]
        - {{ compiler('c') }}  # [not win]
        - libgfortran >=3.0.1  # [osx]
        - llvm-openmp >=4.0.1  # [osx]
        - curl  # [not win]
        - pango 1.*             # [linux]
        - cairo 1.14.*  # [linux]
        - glib 2.*  # [linux]
      test:
        commands:
          - $R -e "print('Hello World!')"           # [not win]
          - "\"%R%\" -e \"print('Hello World!')\""  # [win]

#  - name: r-base
#    version: {{ version }}
#    requirements:
#      build:
#        - {{ pin_subpackage('mro-base', min_pin='x.x.x.x', max_pin='x.x.x.x') }}
#      run:
#        - {{ pin_subpackage('mro-base', min_pin='x.x.x.x', max_pin='x.x.x.x') }}


  - name: r-kernsmooth
    version: '2.23_15'
    script: install-r-package.sh
    # This is required to make R link correctly on Linux.
    build:

      rpaths:
        - lib/R/lib/
        - lib/

    # Suggests: MASS
    requirements:
      build:
        - m2-base  # [win]
      host:
        - mro-base {{ version }}
        - libgfortran >=3.0.1  # [osx]
      run:
        - mro-base {{ version }}
        - libgfortran >=3.0.1  # [osx]

    test:
      commands:
        # You can put additional test commands to be run here.
        - $R -e "library('KernSmooth')"           # [not win]
        - "\"%R%\" -e \"library('KernSmooth')\""  # [win]

    about:
      home: https://mran.microsoft.com/package/KernSmooth
      license: Unlimited
      summary: 'Functions for kernel smoothing (and density estimation) corresponding to the book:  Wand,
        M.P. and Jones, M.C. (1995) "Kernel Smoothing".'
      
      license_family: MIT

  - name: r-mass
    version: '7.3_47'
    script: install-r-package.sh
    # This is required to make R link correctly on Linux.
    build:

      rpaths:
        - lib/R/lib/
        - lib/

    # Suggests: lattice, nlme, nnet, survival
    requirements:
      build:
        - m2-base  # [win]
      host:
        - mro-base {{ version }}
      run:
        - mro-base {{ version }}

    test:
      commands:
        # You can put additional test commands to be run here.
        - $R -e "library('MASS')"           # [not win]
        - "\"%R%\" -e \"library('MASS')\""  # [win]

    about:
      home: http://www.stats.ox.ac.uk/pub/MASS4/
      license: GPL-2 | GPL-3
      summary: Functions and datasets to support Venables and Ripley, "Modern Applied Statistics
        with S" (4th edition, 2002).
      license_family: GPL3

  - name: r-matrix
    version: '1.2_12'
    script: install-r-package.sh
    # This is required to make R link correctly on Linux.
    build:

      rpaths:
        - lib/R/lib/
        - lib/

    # Suggests: expm, MASS
    requirements:
      build:
        - m2-base  # [win]
      host:
        - mro-base {{ version }}
        - {{ pin_subpackage('r-lattice', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - libgfortran >=3.0.1  # [osx]
      run:
        - mro-base {{ version }}
        - {{ pin_subpackage('r-lattice', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - libgfortran >=3.0.1  # [osx]

    test:
      commands:
        # You can put additional test commands to be run here.
        - $R -e "library('Matrix')"           # [not win]
        - "\"%R%\" -e \"library('Matrix')\""  # [win]

    about:
      home: http://Matrix.R-forge.R-project.org/
      license: GPL (>= 2) | file LICENCE
      summary: A rich hierarchy of matrix classes, including triangular, symmetric, and diagonal
        matrices, both dense and sparse and with pattern, logical and numeric entries.   Numerous
        methods for and operations on these matrices, using 'LAPACK' and 'SuiteSparse' libraries.
      license_family: GPL3

  - name: r-microsoftr
    version: '3.4.3.0097'
    script: install-r-package.sh
    # This is required to make R link correctly on Linux.
    build:

      rpaths:
        - lib/R/lib/
        - lib/


    requirements:
      build:
        - m2-base  # [win]
      host:
        - mro-base {{ version }}
      run:
        - mro-base {{ version }}

    test:
      commands:
        # You can put additional test commands to be run here.
        - $R -e "library('MicrosoftR')"           # [not win]
        - "\"%R%\" -e \"library('MicrosoftR')\""  # [win]

    about:
      home: https://mran.microsoft.com/package/MicrosoftR
      license: file LICENSE
      summary: Umbrella package with licenses and notices for all Microsoft R packages
      license_family: OTHER

  - name: r-r6
    version: '2.2.2'
    script: install-r-package.sh
    # This is required to make R link correctly on Linux.
    build:

      rpaths:
        - lib/R/lib/
        - lib/

    # Suggests: knitr, microbenchmark, pryr, testthat, ggplot2, scales
    requirements:
      build:
        - m2-base  # [win]
      host:
        - mro-base {{ version }}
      run:
        - mro-base {{ version }}

    test:
      commands:
        # You can put additional test commands to be run here.
        - $R -e "library('R6')"           # [not win]
        - "\"%R%\" -e \"library('R6')\""  # [win]

    about:
      home: https://github.com/wch/R6/
      license: MIT + file LICENSE
      summary: The R6 package allows the creation of classes with reference semantics, similar to
        R's built-in reference classes. Compared to reference classes, R6 classes are simpler
        and lighter-weight, and they are not built on S4 classes so they do not require
        the methods package. These classes allow public and private members, and they support
        inheritance, even when the classes are defined in different packages.
      license_family: MIT

  - name: r-runit
    version: '0.4.26'
    script: install-r-package.sh
    # This is required to make R link correctly on Linux.
    build:

      rpaths:
        - lib/R/lib/
        - lib/


    requirements:
      build:
        - m2-base  # [win]
      host:
        - mro-base {{ version }}
      run:
        - mro-base {{ version }}

    test:
      commands:
        # You can put additional test commands to be run here.
        - $R -e "library('RUnit')"           # [not win]
        - "\"%R%\" -e \"library('RUnit')\""  # [win]

    about:
      home: https://sourceforge.net/projects/runit/
      license: GPL-2
      summary: R functions implementing a standard Unit Testing framework, with additional code inspection
        and report generation tools
      license_family: GPL2

  - name: r-revoioq
    version: '8.0.9'
    script: install-r-package.sh
    # This is required to make R link correctly on Linux.
    build:

      rpaths:
        - lib/R/lib/
        - lib/

    # Suggests: RevoUtils
    requirements:
      build:
        - m2-base  # [win]
      host:
        - mro-base {{ version }}
        - {{ pin_subpackage('r-runit', min_pin='0.4.26', max_pin=None) }}
      run:
        - mro-base {{ version }}
        - {{ pin_subpackage('r-runit', min_pin='0.4.26', max_pin=None) }}

    test:
      commands:
        # You can put additional test commands to be run here.
        - $R -e "library('RevoIOQ')"           # [not win]
        - "\"%R%\" -e \"library('RevoIOQ')\""  # [win]

    about:
      home: https://mran.microsoft.com/package/RevoIOQ
      license: GPL-2
      summary: Test suite for Microsoft R Services.
      license_family: GPL2

  - name: r-revomods
    version: '11.0.0'
    script: install-r-package.sh
    # This is required to make R link correctly on Linux.
    build:

      rpaths:
        - lib/R/lib/
        - lib/


    requirements:
      build:
        - m2-base  # [win]
      host:
        - mro-base {{ version }}
      run:
        - mro-base {{ version }}

    test:
      commands:
        # You can put additional test commands to be run here.
        - $R -e "library('RevoMods')"           # [not win]
        - "\"%R%\" -e \"library('RevoMods')\""  # [win]

    about:
      home: https://mran.microsoft.com/package/RevoMods
      license: GPL-2
      summary: Microsoft modifications and extensions to standard R functions
      license_family: GPL2

  - name: r-revoutilsmath
    version: '10.0.1'
    script: install-r-package.sh
    # This is required to make R link correctly on Linux.
    build:
      skip: True  # [osx]
      rpaths:
        - lib/R/lib/
        - lib/
      always_include_files:
        - lib/R/lib/libRblas.so  # [linux]

    requirements:
      build:
        - m2-base  # [win]
      host:
        - mro-base {{ version }}
        - libgcc-ng >=7.2.0  # [linux]
      run:
        - mro-base {{ version }}
        - libgcc-ng >=7.2.0  # [linux]

    test:
      commands:
        # You can put additional test commands to be run here.
        - $R -e "library('RevoUtilsMath')"           # [not win]
        - "\"%R%\" -e \"library('RevoUtilsMath')\""  # [win]

    about:
      home: https://mran.microsoft.com/package/RevoUtilsMath
      license: file LICENSE
      summary: Utility functions for managing math threading.
      license_family: OTHER

  - name: r-boot
    version: '1.3_20'
    script: install-r-package.sh
    # This is required to make R link correctly on Linux.
    build:

      rpaths:
        - lib/R/lib/
        - lib/

    # Suggests: MASS, survival
    requirements:
      build:
        - m2-base  # [win]
      host:
        - mro-base {{ version }}
      run:
        - mro-base {{ version }}

    test:
      commands:
        # You can put additional test commands to be run here.
        - $R -e "library('boot')"           # [not win]
        - "\"%R%\" -e \"library('boot')\""  # [win]

    about:
      home: https://mran.microsoft.com/package/boot
      license: Unlimited
      summary: Functions and datasets for bootstrapping from the book "Bootstrap Methods and Their
        Application" by A. C. Davison and  D. V. Hinkley (1997, CUP), originally written
        by Angelo Canty for S.
      license_family: MIT

  - name: r-checkpoint
    version: '0.4.3'
    script: install-r-package.sh
    # This is required to make R link correctly on Linux.
    build:

      rpaths:
        - lib/R/lib/
        - lib/

    # Suggests: knitr, rmarkdown, testthat(>= 0.9), MASS, darts, mockery, cli
    requirements:
      build:
        - m2-base  # [win]
      host:
        - mro-base {{ version }}
      run:
        - mro-base {{ version }}

    test:
      commands:
        # You can put additional test commands to be run here.
        - $R -e "library('checkpoint')"           # [not win]
        - "\"%R%\" -e \"library('checkpoint')\""  # [win]

    about:
      home: https://github.com/RevolutionAnalytics/checkpoint
      license: GPL-2
      summary: The goal of checkpoint is to solve the problem of package reproducibility in R. Specifically,
        checkpoint allows you to install packages as they existed on CRAN on a specific
        snapshot date as if you had a CRAN time machine. To achieve reproducibility, the
        checkpoint() function installs the packages required or called by your project and
        scripts to a local library exactly as they existed at the specified point in time.
        Only those packages are available to your project, thereby avoiding any package
        updates that came later and may have altered your results. In this way, anyone using
        checkpoint's checkpoint() can ensure the reproducibility of your scripts or projects
        at any time. To create the snapshot archives, once a day (at midnight UTC) Microsoft
        refreshes the Austria CRAN mirror on the "Microsoft R Archived Network" server (<https://mran.microsoft.com/>).
        Immediately after completion of the rsync mirror process, the process takes a snapshot,
        thus creating the archive. Snapshot archives exist starting from 2014-09-17.
      license_family: GPL2

  - name: r-class
    version: '7.3_14'
    script: install-r-package.sh
    # This is required to make R link correctly on Linux.
    build:

      rpaths:
        - lib/R/lib/
        - lib/


    requirements:
      build:
        - m2-base  # [win]
      host:
        - mro-base {{ version }}
        - {{ pin_subpackage('r-mass', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
      run:
        - mro-base {{ version }}
        - {{ pin_subpackage('r-mass', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}

    test:
      commands:
        # You can put additional test commands to be run here.
        - $R -e "library('class')"           # [not win]
        - "\"%R%\" -e \"library('class')\""  # [win]

    about:
      home: http://www.stats.ox.ac.uk/pub/MASS4/
      license: GPL-2 | GPL-3
      summary: Various functions for classification, including k-nearest neighbour, Learning Vector
        Quantization and Self-Organizing Maps.
      license_family: GPL3

  - name: r-cluster
    version: '2.0.6'
    script: install-r-package.sh
    # This is required to make R link correctly on Linux.
    build:

      rpaths:
        - lib/R/lib/
        - lib/

    # Suggests: MASS
    requirements:
      build:
        - m2-base  # [win]
      host:
        - mro-base {{ version }}
        - libgfortran >=3.0.1  # [osx]
      run:
        - mro-base {{ version }}
        - libgfortran >=3.0.1  # [osx]

    test:
      commands:
        # You can put additional test commands to be run here.
        - $R -e "library('cluster')"           # [not win]
        - "\"%R%\" -e \"library('cluster')\""  # [win]

    about:
      home: https://mran.microsoft.com/package/cluster
      license: GPL (>= 2)
      summary: Methods for Cluster analysis.  Much extended the original from Peter Rousseeuw, Anja
        Struyf and Mia Hubert, based on Kaufman and Rousseeuw (1990) "Finding Groups in
        Data".
      license_family: GPL3

  - name: r-codetools
    version: '0.2_15'
    script: install-r-package.sh
    # This is required to make R link correctly on Linux.
    build:

      rpaths:
        - lib/R/lib/
        - lib/


    requirements:
      build:
        - m2-base  # [win]
      host:
        - mro-base {{ version }}
      run:
        - mro-base {{ version }}

    test:
      commands:
        # You can put additional test commands to be run here.
        - $R -e "library('codetools')"           # [not win]
        - "\"%R%\" -e \"library('codetools')\""  # [win]

    about:
      home: https://mran.microsoft.com/package/codetools
      license: GPL
      summary: Code analysis tools for R.
      license_family: GPL

  - name: r-curl
    version: '3.1'
    script: install-r-package.sh
    # This is required to make R link correctly on Linux.
    build:

      rpaths:
        - lib/R/lib/
        - lib/

    # Suggests: testthat (>= 1.0.0), knitr, jsonlite, rmarkdown, magrittr, httpuv, webutils
    requirements:
      build:
        - m2-base  # [win]
      host:
        - mro-base {{ version }}
        - libcurl  # [osx]
      run:
        - mro-base {{ version }}
        - libcurl  # [osx]

    test:
      commands:
        # You can put additional test commands to be run here.
        - $R -e "library('curl')"           # [not win]
        - "\"%R%\" -e \"library('curl')\""  # [win]

    about:
      home: https://github.com/jeroen/curl#readme (devel) https://curl.haxx.se/libcurl/ (upstream)
      license: MIT + file LICENSE
      summary: The curl() and curl_download() functions provide highly configurable drop-in replacements
        for base url() and download.file() with better performance, support for encryption
        (https, ftps), gzip compression, authentication, and other 'libcurl' goodies. The
        core of the package implements a framework for performing fully customized requests
        where data can be processed either in memory, on disk, or streaming via the callback
        or connection interfaces. Some knowledge of 'libcurl' is recommended; for a more-user-friendly
        web client see the 'httr' package which builds on this package with http specific
        tools and logic.
      license_family: MIT

  - name: r-deployrrserve
    version: '9.0.0'
    script: install-r-package.sh
    # This is required to make R link correctly on Linux.
    build:
      skip: True  # [osx]
      rpaths:
        - lib/R/lib/
        - lib/


    requirements:
      build:
        - m2-base  # [win]
      host:
        - mro-base {{ version }}
        - libstdcxx-ng >=7.2.0  # [linux]
        - libgcc-ng >=7.2.0  # [linux]
      run:
        - mro-base {{ version }}
        - libstdcxx-ng >=7.2.0  # [linux]
        - libgcc-ng >=7.2.0  # [linux]

    test:
      commands:
        # You can put additional test commands to be run here.
        - $R -e "library('deployrRserve')"           # [not win]
        - "\"%R%\" -e \"library('deployrRserve')\""  # [win]

    about:
      home: http://www.rforge.net/Rserve/
      license: GPL version 2
      summary: Rserve acts as a socket server (TCP/IP or local sockets)  which allows binary requests
        to be sent to R. Every connection has a separate workspace and working directory.
        Client-side implementations are available for popular languages such as C/C++ and
        Java, allowing any application to use facilities of R without the need of linking
        to R code. Rserve supports remote connection, user authentication and file transfer.
        A simple R client is included in this package as well.
      license_family: GPL2

  - name: r-doparallel
    version: '1.0.12'
    script: install-r-package.sh
    # This is required to make R link correctly on Linux.
    build:

      rpaths:
        - lib/R/lib/
        - lib/

    # Suggests: caret, mlbench, rpart
    requirements:
      build:
        - m2-base  # [win]
      host:
        - mro-base {{ version }}
        - {{ pin_subpackage('r-foreach', min_pin='1.2.0', max_pin=None) }}
        - {{ pin_subpackage('r-iterators', min_pin='1.0.0', max_pin=None) }}
      run:
        - mro-base {{ version }}
        - {{ pin_subpackage('r-foreach', min_pin='1.2.0', max_pin=None) }}
        - {{ pin_subpackage('r-iterators', min_pin='1.0.0', max_pin=None) }}

    test:
      commands:
        # You can put additional test commands to be run here.
        - $R -e "library('doParallel')"           # [not win]
        - "\"%R%\" -e \"library('doParallel')\""  # [win]

    about:
      home: https://mran.microsoft.com/package/doParallel
      license: GPL-2
      summary: Provides a parallel backend for the %dopar% function using the parallel package.
      license_family: GPL2

  - name: r-foreach
    version: '1.4.5'
    script: install-r-package.sh
    # This is required to make R link correctly on Linux.
    build:

      rpaths:
        - lib/R/lib/
        - lib/

    # Suggests: randomForest
    requirements:
      build:
        - m2-base  # [win]
      host:
        - mro-base {{ version }}
        - {{ pin_subpackage('r-codetools', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - {{ pin_subpackage('r-iterators', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
      run:
        - mro-base {{ version }}
        - {{ pin_subpackage('r-codetools', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - {{ pin_subpackage('r-iterators', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}

    test:
      commands:
        # You can put additional test commands to be run here.
        - $R -e "library('foreach')"           # [not win]
        - "\"%R%\" -e \"library('foreach')\""  # [win]

    about:
      home: https://mran.microsoft.com/package/foreach
      license: Apache License (== 2.0)
      summary: Support for the foreach looping construct.  Foreach is an idiom that allows for iterating
        over elements in a collection, without the use of an explicit loop counter.  This
        package in particular is intended to be used for its return value, rather than for
        its side effects.  In that sense, it is similar to the standard lapply function,
        but doesn't require the evaluation of a function.  Using foreach without side effects
        also facilitates executing the loop in parallel.
      license_family: APACHE

  - name: r-foreign
    version: '0.8_69'
    script: install-r-package.sh
    # This is required to make R link correctly on Linux.
    build:

      rpaths:
        - lib/R/lib/
        - lib/


    requirements:
      build:
        - m2-base  # [win]
      host:
        - mro-base {{ version }}
      run:
        - mro-base {{ version }}

    test:
      commands:
        # You can put additional test commands to be run here.
        - $R -e "library('foreign')"           # [not win]
        - "\"%R%\" -e \"library('foreign')\""  # [win]

    about:
      home: https://mran.microsoft.com/package/foreign
      license: GPL (>= 2)
      summary: Reading and writing data stored by some versions of 'Epi Info', 'Minitab', 'S', 'SAS',
        'SPSS', 'Stata', 'Systat', 'Weka', and for reading and writing some 'dBase' files.
      license_family: GPL3

  - name: r-iterators
    version: '1.0.9'
    script: install-r-package.sh
    # This is required to make R link correctly on Linux.
    build:

      rpaths:
        - lib/R/lib/
        - lib/

    # Suggests: RUnit
    requirements:
      build:
        - m2-base  # [win]
      host:
        - mro-base {{ version }}
      run:
        - mro-base {{ version }}

    test:
      commands:
        # You can put additional test commands to be run here.
        - $R -e "library('iterators')"           # [not win]
        - "\"%R%\" -e \"library('iterators')\""  # [win]

    about:
      home: https://mran.microsoft.com/package/iterators
      license: Apache License (== 2.0)
      summary: Support for iterators, which allow a programmer to traverse through all the elements
        of a vector, list, or other collection of data.
      license_family: APACHE

  - name: r-jsonlite
    version: '1.5'
    script: install-r-package.sh
    # This is required to make R link correctly on Linux.
    build:

      rpaths:
        - lib/R/lib/
        - lib/

    # Suggests: httr, curl, plyr, testthat, knitr, rmarkdown, R.rsp, sp
    requirements:
      build:
        - m2-base  # [win]
      host:
        - mro-base {{ version }}
      run:
        - mro-base {{ version }}

    test:
      commands:
        # You can put additional test commands to be run here.
        - $R -e "library('jsonlite')"           # [not win]
        - "\"%R%\" -e \"library('jsonlite')\""  # [win]

    about:
      home: https://arxiv.org/abs/1403.2805, https://www.opencpu.org/posts/jsonlite-a-smarter-json-encoder
      license: MIT + file LICENSE
      summary: A fast JSON parser and generator optimized for statistical data and the web. Started
        out as a fork of 'RJSONIO', but has been completely rewritten in recent versions.
        The package offers flexible, robust, high performance tools for working with JSON
        in R and is particularly powerful for building pipelines and interacting with a
        web API. The implementation is based on the mapping described in the vignette (Ooms,
        2014). In addition to converting JSON data from/to R objects, 'jsonlite' contains
        functions to stream, validate, and prettify JSON data. The unit tests included with
        the package verify that all edge cases are encoded and decoded consistently for
        use with dynamic data in systems and applications.
      license_family: MIT

  - name: r-lattice
    version: '0.20_35'
    script: install-r-package.sh
    # This is required to make R link correctly on Linux.
    build:

      rpaths:
        - lib/R/lib/
        - lib/

    # Suggests: KernSmooth, MASS, latticeExtra
    requirements:
      build:
        - m2-base  # [win]
      host:
        - mro-base {{ version }}
      run:
        - mro-base {{ version }}

    test:
      commands:
        # You can put additional test commands to be run here.
        - $R -e "library('lattice')"           # [not win]
        - "\"%R%\" -e \"library('lattice')\""  # [win]

    about:
      home: http://lattice.r-forge.r-project.org/
      license: GPL (>= 2)
      summary: A powerful and elegant high-level data visualization system inspired by Trellis graphics,
        with an emphasis on multivariate data. Lattice is sufficient for typical graphics
        needs, and is also flexible enough to handle most nonstandard requirements. See
        ?Lattice for an introduction.
      license_family: GPL3

  - name: r-mgcv
    version: '1.8_22'
    script: install-r-package.sh
    # This is required to make R link correctly on Linux.
    build:

      rpaths:
        - lib/R/lib/
        - lib/

    # Suggests: splines, parallel, survival, MASS
    requirements:
      build:
        - m2-base  # [win]
      host:
        - mro-base {{ version }}
        - {{ pin_subpackage('r-matrix', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - {{ pin_subpackage('r-nlme', min_pin='3.1_64', max_pin=None) }}
        - libgcc-ng >=7.2.0  # [linux]
        - libgfortran >=3.0.1  # [osx]
        - llvm-openmp >=4.0.1  # [osx]
      run:
        - mro-base {{ version }}
        - {{ pin_subpackage('r-matrix', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - {{ pin_subpackage('r-nlme', min_pin='3.1_64', max_pin=None) }}
        - libgcc-ng >=7.2.0  # [linux]
        - libgfortran >=3.0.1  # [osx]
        - llvm-openmp >=4.0.1  # [osx]

    test:
      commands:
        # You can put additional test commands to be run here.
        - $R -e "library('mgcv')"           # [not win]
        - "\"%R%\" -e \"library('mgcv')\""  # [win]

    about:
      home: https://mran.microsoft.com/package/mgcv
      license: GPL (>= 2)
      summary: Generalized additive (mixed) models, some of their extensions and  other generalized
        ridge regression with multiple smoothing  parameter estimation by (Restricted) Marginal
        Likelihood,  Generalized Cross Validation and similar. Includes a gam()  function,
        a wide variety of smoothers, JAGS support and  distributions beyond the exponential
        family.
      license_family: GPL3

  - name: r-nlme
    version: '3.1_131'
    script: install-r-package.sh
    # This is required to make R link correctly on Linux.
    build:

      rpaths:
        - lib/R/lib/
        - lib/

    # Suggests: Hmisc, MASS
    requirements:
      build:
        - m2-base  # [win]
      host:
        - mro-base {{ version }}
        - {{ pin_subpackage('r-lattice', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - libgfortran >=3.0.1  # [osx]
      run:
        - mro-base {{ version }}
        - {{ pin_subpackage('r-lattice', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - libgfortran >=3.0.1  # [osx]

    test:
      commands:
        # You can put additional test commands to be run here.
        - $R -e "library('nlme')"           # [not win]
        - "\"%R%\" -e \"library('nlme')\""  # [win]

    about:
      home: https://mran.microsoft.com/package/nlme
      license: GPL (>= 2) | file LICENCE
      summary: Fit and compare Gaussian linear and nonlinear mixed-effects models.
      license_family: GPL3

  - name: r-nnet
    version: '7.3_12'
    script: install-r-package.sh
    # This is required to make R link correctly on Linux.
    build:

      rpaths:
        - lib/R/lib/
        - lib/

    # Suggests: MASS
    requirements:
      build:
        - m2-base  # [win]
      host:
        - mro-base {{ version }}
      run:
        - mro-base {{ version }}

    test:
      commands:
        # You can put additional test commands to be run here.
        - $R -e "library('nnet')"           # [not win]
        - "\"%R%\" -e \"library('nnet')\""  # [win]

    about:
      home: http://www.stats.ox.ac.uk/pub/MASS4/
      license: GPL-2 | GPL-3
      summary: Software for feed-forward neural networks with a single hidden layer, and for multinomial
        log-linear models.
      license_family: GPL3

  - name: r-png
    version: '0.1_7'
    script: install-r-package.sh
    # This is required to make R link correctly on Linux.
    build:

      rpaths:
        - lib/R/lib/
        - lib/


    requirements:
      build:
        - m2-base  # [win]
      host:
        - mro-base {{ version }}
      run:
        - mro-base {{ version }}

    test:
      commands:
        # You can put additional test commands to be run here.
        - $R -e "library('png')"           # [not win]
        - "\"%R%\" -e \"library('png')\""  # [win]

    about:
      home: http://www.rforge.net/png/
      license: GPL-2 | GPL-3
      summary: This package provides an easy and simple way to read, write and display bitmap images
        stored in the PNG format. It can read and write both files and in-memory raw vectors.
      license_family: GPL3

  - name: r-rpart
    version: '4.1_11'
    script: install-r-package.sh
    # This is required to make R link correctly on Linux.
    build:

      rpaths:
        - lib/R/lib/
        - lib/

    # Suggests: survival
    requirements:
      build:
        - m2-base  # [win]
      host:
        - mro-base {{ version }}
      run:
        - mro-base {{ version }}

    test:
      commands:
        # You can put additional test commands to be run here.
        - $R -e "library('rpart')"           # [not win]
        - "\"%R%\" -e \"library('rpart')\""  # [win]

    about:
      home: https://mran.microsoft.com/package/rpart
      license: GPL-2 | GPL-3
      summary: Recursive partitioning for classification,  regression and survival trees.  An implementation
        of most of the  functionality of the 1984 book by Breiman, Friedman, Olshen and
        Stone.
      license_family: GPL3

  - name: r-spatial
    version: '7.3_11'
    script: install-r-package.sh
    # This is required to make R link correctly on Linux.
    build:

      rpaths:
        - lib/R/lib/
        - lib/

    # Suggests: MASS
    requirements:
      build:
        - m2-base  # [win]
      host:
        - mro-base {{ version }}
      run:
        - mro-base {{ version }}

    test:
      commands:
        # You can put additional test commands to be run here.
        - $R -e "library('spatial')"           # [not win]
        - "\"%R%\" -e \"library('spatial')\""  # [win]

    about:
      home: http://www.stats.ox.ac.uk/pub/MASS4/
      license: GPL-2 | GPL-3
      summary: Functions for kriging and point pattern analysis.
      license_family: GPL3

  - name: r-survival
    version: '2.41_3'
    script: install-r-package.sh
    # This is required to make R link correctly on Linux.
    build:

      rpaths:
        - lib/R/lib/
        - lib/


    requirements:
      build:
        - m2-base  # [win]
      host:
        - mro-base {{ version }}
        - {{ pin_subpackage('r-matrix', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
      run:
        - mro-base {{ version }}
        - {{ pin_subpackage('r-matrix', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}

    test:
      commands:
        # You can put additional test commands to be run here.
        - $R -e "library('survival')"           # [not win]
        - "\"%R%\" -e \"library('survival')\""  # [win]

    about:
      home: https://github.com/therneau/survival
      license: LGPL (>= 2)
      summary: Contains the core survival analysis routines, including definition of Surv objects,  Kaplan-Meier
        and Aalen-Johansen (multi-state) curves, Cox models, and parametric accelerated
        failure time models.
      license_family: LGPL

  - name: r-mrclient  # [linux or win]
    version: {{ rc_version }}  # [linux or win]
    script: install-r-mrclient.sh  # [linux or win]
    build:  # [linux or win]
      missing_dso_whitelist:  # [linux or win]
        - libmpiCC.so  # [linux or win]
        - libcoll.so  # [linux or win]
        - librxmpiCC.so  # [linux or win]
        - libmpio.so.1  # [linux or win]
        - libmpi.so.1  # [linux or win]
        - libmtmpi.so.1  # [linux or win]
    requirements:  # [linux or win]
      host:  # [linux or win]
        - mro-base {{ version }}  # [linux or win]
        # Gotten from unpacking a broken package then:
        # find . -name DESCRIPTION -exec cat {} \; | grep Imports -A2
        - {{ pin_subpackage('r-microsoftr', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux or win]
        - {{ pin_subpackage('r-revoutilsmath', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux or win]
        - {{ pin_subpackage('r-curl', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux or win]
        - {{ pin_subpackage('r-jsonlite', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux or win]
        - {{ pin_subpackage('r-r6', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux or win]
        # - {{ pin_subpackage('r-tools', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux or win]
        # - {{ pin_subpackage('r-stats', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux or win]
        # - {{ pin_subpackage('r-methods', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux or win]
        - {{ pin_subpackage('r-iterators', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux or win]
        - {{ pin_subpackage('r-foreach', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux or win]
        - {{ pin_subpackage('r-rpart', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux or win]
        - {{ pin_subpackage('r-lattice', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux or win]
        - {{ pin_subpackage('r-revomods', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux or win]
        - libstdcxx-ng >=7.2.0  # [linux]
        - libgcc-ng >=7.2.0  # [linux]
        - libcurl  # [linux]
        - libuuid  # [linux]
        - zlib  # [linux]
        - unixodbc  # [linux]
        - openssl  # [linux]
      run:  # [linux or win]
        - {{ pin_subpackage('r-microsoftr', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux or win]
        - {{ pin_subpackage('r-revoutilsmath', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux or win]
        - {{ pin_subpackage('r-curl', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux or win]
        - {{ pin_subpackage('r-jsonlite', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux or win]
        - {{ pin_subpackage('r-r6', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux or win]
        # - {{ pin_subpackage('r-tools', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux or win]
        # - {{ pin_subpackage('r-stats', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux or win]
        # - {{ pin_subpackage('r-methods', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux or win]
        - {{ pin_subpackage('r-iterators', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux or win]
        - {{ pin_subpackage('r-foreach', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux or win]
        - {{ pin_subpackage('r-rpart', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux or win]
        - {{ pin_subpackage('r-lattice', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux or win]
        - {{ pin_subpackage('r-revomods', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux or win]
        - mro-base {{ version }}  # [linux or win]
        - libstdcxx-ng >=7.2.0  # [linux]
        - libgcc-ng >=7.2.0  # [linux]
        - libcurl  # [linux]
        - libuuid  # [linux]
        - zlib  # [linux]
        - unixodbc  # [linux]
    test:  # [linux or win]
      files:  # [linux or win]
        - Flight_Delays_Sample.csv  # [linux or win]
        - Weather_Sample.csv  # [linux or win]
        - test-mrclient-incomplete.R  # [linux or win]
        - test-mrclient.R  # [linux or win]
      commands:  # [linux or win]
        # You cannot use WARNING<colon> here without causing conda-build to die in _trim_None_strings
        - Rscript test-mrclient.R || echo "WARNING .. Ignoring failure of test-mrclient.R, will test an incomplete version instead"  # [linux]
        - Rscript test-mrclient-incomplete.R  # [linux]
        - Rscript test-mrclient.R  # [win]
    about:  # [linux or win]
      home: https://docs.microsoft.com/en-us/machine-learning-server/r-client/what-is-microsoft-r-client  # [linux or win]
      license: Proprietary  # [linux or win]
      summary: A free, community-supported, data science tool for high performance analytics  # [linux or win]
      license_family: Proprietary  # [linux or win]

  - name: r-mrclient-mml  # [linux or win]
    version: {{ rc_version }}  # [linux or win]
    script: install-r-mrclient-mml.sh  # [linux or win]
    build:  # [linux or win]
    requirements:  # [linux or win]
      host:  # [linux or win]
        - mro-base {{ version }}  # [linux or win]
        - {{ pin_subpackage('r-mrclient', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux or win]
      run:  # [linux or win]
        - mro-base {{ version }}  # [linux or win]
        - {{ pin_subpackage('r-mrclient', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux or win]
    test:
      commands:
        # You can put additional test commands to be run here.
        - $R -e "library('MicrosoftML')"           # [not win]
        - "\"%R%\" -e \"library('MicrosoftML')\""  # [win]
    about:  # [linux or win]
      home: https://docs.microsoft.com/en-us/machine-learning-server/r-reference/microsoftml/microsoftml-package  # [linux or win]
      license: Proprietary  # [linux or win]
      summary: Provides state-of-the-art fast, scalable machine learning algorithms and transforms for R  # [linux or win]
      license_family: Proprietary  # [linux or win]

  - name: r-mrclient-mlm  # [linux]
    version: {{ rc_version }}  # [linux]
    script: install-r-mrclient-mlm.sh  # [linux]
    build:  # [linux]
      noarch: generic  # [linux]
    requirements:  # [linux]
      host:  # [linux]
        - mro-base {{ version }}  # [linux]
        - {{ pin_subpackage('r-mrclient-mml', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux]
      run:  # [linux]
        - mro-base {{ version }}  # [linux]
        - {{ pin_subpackage('r-mrclient-mml', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux]
    about:  # [linux]
      home: https://docs.microsoft.com/en-us/machine-learning-server/install/microsoftml-install-pretrained-models  # [linux]
      license: Proprietary  # [linux]
      summary: Pre-trained machine learning models for sentiment analysis and image detection  # [linux]
      license_family: Proprietary  # [linux]

  - name: mro-basics
    version: {{ version }}
    requirements:
      run:
        - {{ pin_subpackage('mro-base', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - {{ pin_subpackage('r-boot', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - {{ pin_subpackage('r-checkpoint', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - {{ pin_subpackage('r-class', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - {{ pin_subpackage('r-cluster', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - {{ pin_subpackage('r-codetools', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - {{ pin_subpackage('r-curl', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - {{ pin_subpackage('r-deployrrserve', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux or win]
        - {{ pin_subpackage('r-doparallel', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - {{ pin_subpackage('r-foreach', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - {{ pin_subpackage('r-foreign', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - {{ pin_subpackage('r-iterators', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - {{ pin_subpackage('r-jsonlite', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - {{ pin_subpackage('r-kernsmooth', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - {{ pin_subpackage('r-lattice', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - {{ pin_subpackage('r-mass', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - {{ pin_subpackage('r-matrix', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - {{ pin_subpackage('r-mgcv', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - {{ pin_subpackage('r-microsoftr', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - {{ pin_subpackage('r-nlme', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - {{ pin_subpackage('r-nnet', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - {{ pin_subpackage('r-png', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - {{ pin_subpackage('r-r6', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - {{ pin_subpackage('r-revoioq', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - {{ pin_subpackage('r-revomods', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - {{ pin_subpackage('r-revoutilsmath', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}  # [linux or win]
        - {{ pin_subpackage('r-rpart', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - {{ pin_subpackage('r-runit', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - {{ pin_subpackage('r-spatial', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
        - {{ pin_subpackage('r-survival', min_pin='x.x.x.x.x.x', max_pin='x.x.x.x.x.x') }}
